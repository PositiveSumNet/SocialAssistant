<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8" >
    <title>Whosum Social Assistant</title>
    <link href="/images/favicon.ico" rel="icon" type="image/x-icon" >
    <link href='css/bootstrap/bootstrap.min.css' rel='stylesheet' >
    <link href='css/bootstrap/flags.css' rel='stylesheet' >
    <link href='css/app.css' rel='stylesheet' >
    <link href='lib/bootstrap-icons/bootstrap-icons.css' rel='stylesheet' >
  </head>
  <body>
    <div class='main container-fluid'>
      <div class="row bg-header inkfree">
        <div class="col">
          <span class="h1"><a href="https://whosum.com" target="_blank">+Î£ Whosum</a></span>
        </div>
        <div class="col-sm-auto my-auto">
          <span class="h5 inkfree text-right my-auto">Locally Cached Social Database</span>
        </div>
      </div>
      <div class="row bg-subheader">
        <div class="col">
          <ul class="nav nav-tabs" style="border-bottom:none;">
            <li class="nav-item">
              <a id="twitterLensBtn" class="nav-link active" aria-current="page" href="#" data-toggle='tooltip' title='Focus on Twitter networks'>
                <i class="bi-twitter"></i>
                Twitter</a>
            </li>
            <li class="nav-item">
              <a id="mastodonLensBtn" class="nav-link" href="#" data-toggle='tooltip' title='Focus on Mastodon networks'>
                <i class="bi-mastodon"></i>
                Mastodon</a>
            </li>
          </ul>
        </div>
        <div class="col-sm-auto text-right">
          <span id='transferringMsg' style="display:none;">
            Copying recent recordings to local database...  | 
          </span>
          <span>
            <a href="#" id="showExportUiBtn" role="button" data-toggle='tooltip' title='export backup files'>Export</a>
            <a href="#" id="stopExportBtn" role="button" data-toggle='tooltip' title='stop file backup' style="display:none;">Cancel Export</a>
            <span>&nbsp;|&nbsp;</span>
            <a href="#" id="startImportBtn" role="button" data-toggle='tooltip' title='import to restore'>Import</a>
            <a href="#" id="stopImportBtn" role="button" data-toggle='tooltip' title='stop import' style="display:none;">Cancel Import</a>
          </span>
        </div>
      </div>
      <div id="exportui" class="row pb-2" style="display:none;">
        <h3>Customize the Export</h3>
        <p class="text-secondary">This will download a set of plain-text files (could be many). To later import, browse to your PC's Downloads folder and you can import in batch.</p>
        <div id="exportOpts" class="row">
          <div class="col">
            <p class="h5 mt-3">For Whom</p>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="optExportWhom" id="optExportWhomAll">
              <label class="form-check-label" for="optExportWhomAll">All networks</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="optExportWhom" id="optExportWhomActiveSiteOnly">
              <label class="form-check-label" id="optExportWhomActiveSiteOnlyLabel" for="optExportWhomActiveSiteOnly">This account type only</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="optExportWhom" id="optExportWhomActiveAccountFollowingOnly">
              <label class="form-check-label" id="optExportWhomActiveAccountFollowingOnlyLabel" for="optExportWhomActiveAccountFollowingOnly">Followed by this account only</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="optExportWhom" id="optExportWhomActiveAccountFollowersOnly">
              <label class="form-check-label" id="optExportWhomActiveAccountFollowersOnlyLabel" for="optExportWhomActiveAccountFollowersOnly">Followers of this account only</label>
            </div>
          </div>
          <div class="col">
            <p class="h5 mt-3">If Modified When</p>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="optExportWhen" id="optExportWhenAll">
              <label class="form-check-label" for="optExportWhenAll">All date ranges</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="optExportWhen" id="optExportWhenLastWeek">
              <label class="form-check-label" for="optExportWhenLastWeek">In the last week</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="optExportWhen" id="optExportWhenLastDay">
              <label class="form-check-label" for="optExportWhenLastDay">In the last day</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="optExportWhen" id="optExportWhenLastHour">
              <label class="form-check-label" for="optExportWhenLastHour">In the last hour</label>
            </div>
          </div>
          <div class="col">
            <p class="h5 mt-3">Which Aspects</p>
            <div class="ms-2" id="exportWhatDetail">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="optExportWhatFollowers">
                <label class="form-check-label" for="optExportWhatFollowers">Followers</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="optExportWhatFollowing">
                <label class="form-check-label" for="optExportWhatFollowing">Following</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="optExportDisplayNames">
                <label class="form-check-label" for="optExportDisplayNames">Profile names</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="optExportProfileDescriptions">
                <label class="form-check-label" for="optExportProfileDescriptions">Profile descriptions</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="optExportProfileLinks">
                <label class="form-check-label" for="optExportProfileLinks">Profile links</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="optExportPhotos">
                <label class="form-check-label" for="optExportPhotos" data-toggle='tooltip' title='These files are relatively large'>Profile photos (big files)</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="optFollowerCounts">
                <label class="form-check-label" for="optExportPhotos">Follower counts</label>
              </div>
            </div>
          </div>
        </div>
        <div class="p-4">
          <a href="#" id="btnConfirmExport" role="button" class="btn btn-primary">Start Export</a>
          <a href="#" id="btnCancelExport" role="button" class="btn btn-secondary ms-2">Cancel</a>
        </div>
      </div>
      <div id="uploadui" class="row pb-2" style="display:none;">
        <div id="powerUserImport" style="display:none;" class="ps-4">
          <p class="h5">Context</p>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="optImportContext" id="optImportContextEntities">
            <label class="form-check-label" for="optImportContextEntities">Simple import</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="optImportContext" id="optImportContextTwitterProfilesToScrape">
            <label class="form-check-label" for="optImportContextTwitterProfilesToScrape">(advanced) Twitter profiles to scrape and save</label>
          </div>
        </div>
        <br>
        <div id="drop-area">
          <form class="my-form">
            <p>Upload multiple files (click or drag & drop)</p>
            <input type="file" id="fileElem" multiple accept="application/JSON">
            <label class="upload-button" for="fileElem">Choose files</label>
          </form>
        </div>
        <div class="pt-3 ps-4">
          <span>Uploaded: </span><span id="uploadedCnt">0</span> | 
          <span>Processed: </span><span id="uploadProcessedCnt">0</span>
        </div>
        <div class="pt-2 ps-4">
          <a href="#" id="uploadDone" role="button" class="btn btn-primary">Done</a>
        </div>
      </div>
      <div id='mdonApiUi' class='row' style="display:none;padding:10px 20px;">
        <div id="mdonOAuthUi">
          <h5><i class="bi-mastodon"></i> Connect to Mastodon</h5>
          <div id="mdonConnectStep1">
            <p>This does NOT share data with our servers. The app runs directly on your device.</p>
            <div class='input-group'>
              <label for='txtMdonServer' class='text-muted input-group-text'>Mastodon server</label>
              <input id='txtMdonServer' style="max-width:250px;" name='txtMdonServer' type='text' placeholder='e.g. mastodon.online' class='form-control' >
            </div>
            <br>
            <p>Click to launch a separate tab to authorize. Then return here.</p>
            <p><a href="#" class="btn btn-primary" role="button" id="mdonLaunchAuthBtn">Connect</a></p>
          </div>
          <div id="mdonConnectStep2">
            <p>Paste the authorization code (from the Mastodon tab that was launched).</p>
            <div class='input-group'>
              <label for='txtMdonAuthCode' class='text-muted input-group-text'>Auth Code</label>
              <input id='txtMdonAuthCode' name='txtMdonAuthCode' type='password' class='form-control' style="max-width:400px;" >
            </div>
            <br>
            <p><a href="#" class="btn btn-primary" role="button" id="mdonAcceptAuthBtn">Test Connection</a></p>
          </div>
          <div>
            <p class="small text-secondary">
              <span>Having trouble? </span>
              <a href="#" id="clearMdonCacheBtn" role="button">Click here</a> 
              <span>to clear the connection cache or </span>
              <a href="mailto:whosumsupport@positivesum.net" target="_blank" role="button">contact us</a>
            </p>
          </div>
        </div>
        <div id="mdonConnError" class="text-danger"></div>
        <div id="mdonReconnecting" style="display:none;">
          <i class="bi-arrow-down-up"></i>
          <span id="mdonReconnectingAs"></span>
          <a href="#" class="btn btn-outline-secondary" style="margin-left:10px;display:inline;" role="button" id="mdonDisconnect2">Disconnect</a>
          <div class="progress mt-3" style="height:3px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"></div>
          </div>
        </div>
        <div id="mdonDownloadConnsUi" class="card">
          <div class="card-header inkfree small" style="padding:0px;background:none;border:none;">
            Download connections of any Mastodon account...
          </div>
          <div class="card-body">
            <span id='loggedInMastodonUser'></span>
            <label for='txtMdonDownloadConnsFor' style="margin-left:10px;width:300px;display:inline;" class='inputlabel text-muted input-group-text'>@</label>
            <input class="textinput" id='txtMdonDownloadConnsFor' style="max-width:300px;display:inline;" name='txtMdonDownloadConnsFor' type='text' placeholder="account to analyze" >
            <a href="#" class="btn btn-outline-danger p-2" style="margin-left:10px;display:none;" role="button" id="mdonStopDownloadBtn">Stop</a>
            <a href="#" class="btn btn-primary p-2" style="margin-left:10px;display:inline;" role="button" id="mdonDownloadFollowingListBtn">Save Following List</a>
            <a href="#" class="btn btn-secondary p-2" style="margin-left:10px;display:inline;" role="button" id="mdonDownloadFollowersListBtn">Save Followers</a>
            <a href="#" class="btn btn-outline-secondary p-2" style="margin-left:10px;display:inline;" role="button" id="mdonDisconnect">Disconnect</a>
            <span class="text-secondary" style="margin-left:10px;display:inline;">
              <i id="mastodonDownloadingIcon" class="bi-cloud-download-fill" style="display:none;" data-toggle='tooltip' title='Download status'></i>
              <span id='mastodonDownloadStatus' data-toggle='tooltip' title='Download status'></span>
            </span>
            <span class="text-secondary" style="margin-left:10px;display:inline;">
              <i id="mastodonSavingDoneIcon" class="bi-check-circle-fill text-success" style="display:none;" data-toggle='tooltip' title='Save complete!'></i>
              <i id="mastodonSavingIcon" class="bi-save-fill" style="display:none;" data-toggle='tooltip' title='Save status'></i>
              <span id='mastodonSavingStatus' data-toggle='tooltip' title='Save status'></span>
            </span>
          </div>
          <div class="card-footer inkfree small" style="padding:0px;background:none;border:none;">
            Then explore what you've saved and follow interesting people!
          </div>
        </div>
        <div id='mdonRemoteOwnerPivotPicker' class='pt-2' style="display:none;"></div>
      </div>
      <div id="dbui" class="row pb-2 container-fluid">
        <div id="listFilterSet" class='row'>
          <div id='followDirection' class='col-sm-auto pt-2'>
            <select id="cmbType" class="form-select">
              <option id="optFollowedByWhom" value="following">Followed by</option>
              <option id="optFollowersOfWhom" value="followers">Followers of</option>
              <option id="optPosts" value="posts">Posts</option>
            </select>
          </div>
          <div class='pt-2 col-2'>
            <div class='input-group' style="margin-bottom:20px;">
              <label for='txtOwnerHandle' class='text-muted input-group-text'>@</label>
              <input id='txtOwnerHandle' type='text' placeholder='account' class='form-control' >
            </div>
          </div>
          <div class='pt-2 col-2'>
            <input id='txtSearch' type='text' class='form-control' placeholder='search...' >
          </div>
          <div id="paging" class='pt-2 col-2' style="white-space:nowrap!important;">
            <label for='txtPageNum' class='text-muted'>pg</label>
            <input id='txtPageNum' type='text' style='border-right:none;' value='1' >
            <a data-toggle='tooltip' title='prior page' href='#' id='priorPage' role='button'><i class="bi-chevron-double-left"></i></a>
            <a data-toggle='tooltip' title='next page' href='#' id='nextPage' role='button'><i class="bi-chevron-double-right"></i></a>
            <a data-toggle='tooltip' title='set page size' href='#' id='pageGear' role='button'><i class="bi-gear"></i></a>
          </div>
          <div id='queryOptions' class='col-4' style="margin-left:25px;display:none;float:right;">
            <table>
              <tr>
                <td>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="chkMutual" id="chkMutual" data-toggle='tooltip' title='Where mutually followed by the selected person'>
                    <label class="form-check-label" for="chkMutual" data-toggle='tooltip' title='Where mutually followed by the selected person'>Mutual follow</label>
                  </div>
                </td>
                <td>
                  <div class="form-check" id="filterTwitterWithMdonLink">
                    <input class="form-check-input" type="radio" name="optWith" id="optWithMdon">
                    <label class="form-check-label" for="optWithMdon">
                      <span>Mastodon</span>
                      <a data-toggle='tooltip' title='For the best experience, enter the server where you have an account, e.g. toad.social' href='#' id='mdonGear'><i class="bi-gear"></i></a>
                    </label>
                  </div>
                  <div class="form-check" style="display:none;" id="filterMdonImFollowing">
                    <input class="form-check-input chk-tristate" type="checkbox" name="chkMdonImFollowing" id="chkMdonImFollowing" title='Where I follow them on Mastodon - true/false/unfiltered'>
                    <label class="form-check-label" for="chkMdonImFollowing" data-toggle='tooltip' title='Where I follow them on Mastodon - true/false/unfiltered'><i class="bi-mastodon text-mastodon"></i> I follow</label>
                  </div>
                </td>
                <td>
                  <div class="form-check" id="filterWithEmail">
                    <input class="form-check-input" type="radio" name="optWith" id="optWithEmail" data-toggle='tooltip' title='Where an email address is available'>
                    <label class="form-check-label" for="optWithEmail" data-toggle='tooltip' title='Where an email address is available'>w/ Email</label>
                  </div>
                  <a id="btnFollowAllOnMastodon" href="#" class="btn btn-primary mb-1" style="display:none;margin-top:-2px;" data-toggle='tooltip' title='Follow these accounts on Mastodon (just those currently in view)'><i class="bi-mastodon"></i> Follow!</a>
                </td>
              </tr>
              <tr>
                <td>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="chkFavorited" id="chkFavorited">
                    <label class="form-check-label" for="chkFavorited">Favorite</label>
                  </div>
                </td>
                <td>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="optWith" id="optWithUrl" data-toggle='tooltip' title='Where a URL is available'>
                    <label class="form-check-label" for="optWithUrl" data-toggle='tooltip' title='Where a URL is available'>w/ Url</label>
                  </div>
                </td>
                <td>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="optWith" id="optClear" data-toggle='tooltip' title='Remove filters'>
                    <label class="form-check-label" for="optClear" data-toggle='tooltip' title='Remove filters'>w/ Any</label>
                  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div id="connListProgress" class="progress" style="height:3px;">
          <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"></div>
        </div>
        <div id='listOwnerPivotPicker' class='row pt-2'></div>
        <div class='listMain row' id='connListMain'>
          <div id='paginated-list' aria-live='polite'>
          </div>
        </div>
      </div>
    </div>
    <div class="fixed-bottom row">
      <div class="col">
        <span>App Version: <span id='manifestVersion'></span></span>, 
        <span>SQLite DB Version: <span id='sqliteVersionLib'></span></span>, 
        <span>OPFS: <span id='sqliteOpfsOk'></span></span>, 
        <span>Script #: <span id='dbScriptNumber'></span></span> |
        <a href='https://whosum.com/privacy' target='_blank'>Privacy</a> |
        <a href='https://whosum.com/terms' target='_blank'>Terms</a> |
        <a href='https://github.com/positivesumnet/socialassistant' target='_blank'>Code</a> |
        <a href='https://whosum.com/assistant' target='_blank'>Videos</a> |
        <a href='https://whosum.com/faq' target='_blank'>Help</a>
      </div>
      <div id="bgStatusMsg" class="col-sm-auto text-right me-4">
        
      </div>
    </div>
    <script src='lib/shared/purify.min.js'></script>
    <script src='lib/shared/constants.js'></script>
    <script src='lib/shared/pagetypes.js'></script>
    <script src='lib/shared/settingslib.js'></script>
    <script src='lib/shared/es6lib.js'></script>
    <script src='lib/shared/strlib.js'></script>
    <script src='lib/shared/imagelib.js'></script>
    <script src='lib/shared/emojilib.js'></script>
    <script src='lib/shared/datatypes.js'></script>
    <script src='lib/shared/appgraphs.js'></script>
    <script src='lib/shared/bgfetchlib.js'></script>
    <script src='lib/shared/appschema.js'></script>
    <script src='lib/dbui/renderlib.js'></script>
    <script src='lib/dbui/connexportlib.js'></script>
    <script src='lib/apis/mastodonlib.js'></script>
    <script src='index.js'></script>
  </body>
</html>
